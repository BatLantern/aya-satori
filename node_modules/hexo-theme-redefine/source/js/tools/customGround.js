console.log('customGround.js loaded');

let isFirstLoad = true;

function loadBackgroundImage() {
    fetch('https://t.alcy.cc/ycy/?json')
        .then(response => response.json())
        .then(data => {

            console.log('Data fetched:', data);

            const backgroundImageUrl = data.url;
            const mainContentBody = document.querySelector('.main-content-body');

            console.log('url data:', backgroundImageUrl);

            if (!mainContentBody) {
                console.error('No target element found with selector!!');
                return;
            }
            mainContentBody.style.backgroundImage = `url(${backgroundImageUrl})`;

            console.log('url setting succeed:', mainContentBody.style.backgroundImage);

            if (!mainContentBody.style.backgroundImage) {
                console.error('Failed to set image!!');
            }
        })
        .catch(error => {
            console.error('Error fetching image!!:', error);
        });
}

window.addEventListener('load', function() {
    if (window.location.pathname !== '/') {
        if (isFirstLoad) {
            loadBackgroundImage();
            isFirstLoad = false; 
        }
    }
});